{"title":"Hive搭建 centos","slug":"tools/hive","date":"2019-12-26T15:40:51.000Z","updated":"2024-06-30T10:35:56.312Z","comments":true,"path":"api/articles/tools/hive.json","excerpt":null,"covers":null,"content":"<p>[toc]</p>\n<h4 id=\"centos下-Hive搭建（mysql、hadoop-、jdk）\"><a href=\"#centos下-Hive搭建（mysql、hadoop-、jdk）\" class=\"headerlink\" title=\"centos下 Hive搭建（mysql、hadoop 、jdk）\"></a>centos下 Hive搭建（mysql、hadoop 、jdk）</h4><h4 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h4><ol>\n<li><p> wget <a href=\"https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\">https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm</a></p>\n</li>\n<li><p>```<br> rpm -ivh mysql80-community-release-el7-3.noarch.rpm</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">3.  &#96;&#96;&#96;</span><br><span class=\"line\">    yum install mysql-community-server -y</span><br><span class=\"line\">    systemctl enable mysqld</span><br><span class=\"line\">    systemctl start mysqld</span><br><span class=\"line\">    grep &#39;temporary password&#39; &#x2F;var&#x2F;log&#x2F;mysqld.log #获得密码</span><br><span class=\"line\">    mysql -u root -p</span><br><span class=\"line\">    mysql&gt; set global validate_password.policy&#x3D;0;</span><br><span class=\"line\">    mysql&gt; set global validate_password.length&#x3D;1;</span><br><span class=\"line\">    mysql&gt; alter user &#39;root&#39;@&#39;localhost&#39; identified by &#39;password&#39;;</span><br><span class=\"line\">    firewall-cmd --zone&#x3D;public --add-port&#x3D;3306&#x2F;tcp --permanent</span><br><span class=\"line\">    firewall-cmd --reload</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>完整脚本</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm</span><br><span class=\"line\">rpm -ivh mysql80-community-release-el7-3.noarch.rpm</span><br><span class=\"line\">yum install mysql-community-server -y</span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> mysqld</span><br><span class=\"line\">systemctl start mysqld</span><br><span class=\"line\">grep <span class=\"string\">&#x27;temporary password&#x27;</span> /var/<span class=\"built_in\">log</span>/mysqld.log <span class=\"comment\">#获得密码</span></span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">mysql&gt; <span class=\"built_in\">set</span> global validate_password.policy=0;</span><br><span class=\"line\">mysql&gt; <span class=\"built_in\">set</span> global validate_password.length=1;</span><br><span class=\"line\">mysql&gt; alter user <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> identified by <span class=\"string\">&#x27;password&#x27;</span>;</span><br><span class=\"line\">firewall-cmd --zone=public --add-port=3306/tcp --permanent</span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"hadoop安装\"><a href=\"#hadoop安装\" class=\"headerlink\" title=\"hadoop安装\"></a>hadoop安装</h4><p>Hadoop的核心由3个部分组成：</p>\n<p>  HDFS: Hadoop Distributed File System，分布式文件系统，hdfs还可以再细分为NameNode、SecondaryNameNode、DataNode。</p>\n<p>  YARN: Yet Another Resource Negotiator，资源管理调度系统</p>\n<p>  Mapreduce：分布式运算框架</p>\n<p>1.安装jdk7或8（不支持11）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载</span></span><br><span class=\"line\">wget -O jdk-8u131-linux-x64.tar.gz --no-check-certificate --no-cookies --header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar zxvf ~/jdk-8u131-linux-x64.tar.gz -C /usr/local/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置环境</span></span><br><span class=\"line\">vi /etc/profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">  后面添加</span></span><br><span class=\"line\">export JAVA_HOME=/usr/local/jdk1.8.0_131</span><br><span class=\"line\">export CLASSPATH=$CLASSPATH:$JAVA_HOME/lib/</span><br><span class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">重新加载配置</span></span><br><span class=\"line\">source /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">验证</span></span><br><span class=\"line\">java -version</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载hadoop</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> wget https://downloads.apache.org/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz</span></span><br><span class=\"line\">wget http://mirror.bit.edu.cn/apache/hadoop/common/hadoop-2.10.1/hadoop-2.10.1.tar.gz</span><br><span class=\"line\">tar zxvf hadoop-2.10.1.tar.gz -C /usr/local/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">配置jdk</span></span><br><span class=\"line\">vi $&#123;HADOOP_HMOE&#125;/etc/hadoop/hadoop-003env.sh</span><br><span class=\"line\">export JAVA_HOME=/usr/local/jdk1.8.0_131/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">设置伪分布模式（Pseudo-Distributed Operation）修改etc/hadoop/core-site.xml文件，增加配置（fs.defaultFS：默认文件系统名称）：</span></span><br><span class=\"line\">vi $&#123;HADOOP_HMOE&#125;/etc/hadoop/core-site.xml</span><br><span class=\"line\">&lt;configuration&gt;</span><br><span class=\"line\">    &lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;</span><br><span class=\"line\">    &lt;/property&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"> #</span><span class=\"bash\"> 修改etc/hadoop/hdfs-site.xml文件，增加配置（dfs.replication：文件副本数）：</span></span><br><span class=\"line\"> &lt;configuration&gt;</span><br><span class=\"line\">    &lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;1&lt;/value&gt;</span><br><span class=\"line\">    &lt;/property&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">格式化文件系统</span></span><br><span class=\"line\">/usr/local/hadoop-2.10.1/bin/hdfs namenode -format</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动NameNode和DataNode进程（启动hdfs）</span></span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/start-dfs.sh // 启动NameNode和DataNode进程</span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/stop-dfs.sh  // 关闭NameNode和DataNode进程</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">查看HDFS验证成功</span></span><br><span class=\"line\">http://172.20.19.33:50070</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动yarn</span></span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/start-yarn.sh</span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/stop-yarn.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">查看YARN</span></span><br><span class=\"line\">http://172.20.19.33:8088/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置环境</span></span><br><span class=\"line\">vi /etc/profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">  后面添加</span></span><br><span class=\"line\">export HADOOP_HOME=/usr/local/hadoop-2.10.1</span><br><span class=\"line\">export PATH=$PATH:$HADOOP_HOME/bin</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">重新加载配置</span></span><br><span class=\"line\">source /etc/profile</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Hive安装\"><a href=\"#Hive安装\" class=\"headerlink\" title=\"Hive安装\"></a>Hive安装</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 下载</span></span><br><span class=\"line\">wget https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz -c #比较慢，断点下载</span><br><span class=\"line\">tar zxvf apache-hive-3.1.2-bin.tar.gz -C /usr/local/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">改名去bin</span></span><br><span class=\"line\">mv apache-hive-3.1.2-bin/ apache-hive-3.1.2/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">配置</span></span><br><span class=\"line\">cd /usr/local/apache-hive-3.1.2/conf/</span><br><span class=\"line\">cp hive-log4j2.properties.template hive-log4j2.properties</span><br><span class=\"line\">vi /usr/local/apache-hive-3.1.2/conf/hive-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span><br><span class=\"line\">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class=\"line\">&lt;configuration&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class=\"line\">    &lt;value&gt;jdbc:mysql://172.20.19.33:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt;</span><br><span class=\"line\">　&lt;/property&gt;</span><br><span class=\"line\">　&lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class=\"line\">　　&lt;value&gt;com.mysql.cj.jdbc.Driver&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class=\"line\">    &lt;value&gt;root&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class=\"line\">    &lt;value&gt;password&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">初始化数据库</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载并拷贝protobuf-java-3.6.1.jar和mysql-connector-java-8.0.17.jar到<span class=\"variable\">$HIVE_HOME</span>/lib目录下，删除已有的protobuf-java-2.5.0.jar文件。统一hive和mysql服务的时区。</span></span><br><span class=\"line\">wget -c https://repo1.maven.org/maven2/com/google/protobuf/protobuf-java/3.6.1/protobuf-java-3.6.1.jar</span><br><span class=\"line\">wget -c https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.17/mysql-connector-java-8.0.17.jar</span><br><span class=\"line\">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # hive和mysql服务器都要执行，mysql要重启服务</span><br><span class=\"line\">cd /usr/local/apache-hive-3.1.2/bin/</span><br><span class=\"line\">/usr/local/apache-hive-3.1.2/bin/schematool -dbType mysql -initSchema # 报错需要修改mysql访问权限</span><br><span class=\"line\">/usr/local/apache-hive-3.1.2/bin/hive</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">  启动hiveserver2：</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 修改<span class=\"variable\">$HADOOP_HOME</span>/etc/hadoop/core-site.xml文件，增加如下配置：</span></span><br><span class=\"line\">vi /usr/local/hadoop-2.10.1/etc/hadoop/core-site.xml</span><br><span class=\"line\">&lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\">&lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\">&lt;property&gt;</span><br><span class=\"line\">         &lt;name&gt;hadoop.proxyuser.hadoop.hosts&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\"> &lt;property&gt;</span><br><span class=\"line\">         &lt;name&gt;hadoop.proxyuser.hadoop.groups&lt;/name&gt;</span><br><span class=\"line\">         &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">vi /usr/local/apache-hive-3.1.2/conf/hive-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">     &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;</span><br><span class=\"line\">     &lt;value&gt;10000&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">     &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;</span><br><span class=\"line\">     &lt;value&gt;172.20.19.33&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">/usr/local/apache-hive-3.1.2/bin/hiveserver2 &amp;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>mysql权限修改</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 改表法</span></span><br><span class=\"line\">mysql -u root -pvmware</span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span><span class=\"bash\">use mysql;</span></span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span><span class=\"bash\">update user <span class=\"built_in\">set</span> host = <span class=\"string\">&#x27;%&#x27;</span> <span class=\"built_in\">where</span> user = <span class=\"string\">&#x27;root&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span><span class=\"bash\">flush privileges;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h5 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h5><p><strong>Hive Shell 、Hive Web UI及JDBC 三种连接Hive Server的方式是互斥的，同一时刻只能用一种方式连接</strong></p>\n<h3 id=\"端口说明\"><a href=\"#端口说明\" class=\"headerlink\" title=\"端口说明\"></a>端口说明</h3><table>\n<thead>\n<tr>\n<th>组件</th>\n<th>Daemon</th>\n<th>端口</th>\n<th>配置</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>HDFS</td>\n<td>DataNode</td>\n<td>50010</td>\n<td>dfs.datanode.address</td>\n<td>datanode服务端口，用于数据传输</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50075</td>\n<td>dfs.datanode.http.address</td>\n<td>http服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50475</td>\n<td>dfs.datanode.https.address</td>\n<td>https服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50020</td>\n<td>dfs.datanode.ipc.address</td>\n<td>ipc服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td>NameNode</td>\n<td>50070</td>\n<td>dfs.namenode.http-address</td>\n<td>http服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50470</td>\n<td>dfs.namenode.https-address</td>\n<td>https服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8020</td>\n<td>fs.defaultFS</td>\n<td>接收Client连接的RPC端口，用于获取文件系统metadata信息。</td>\n</tr>\n<tr>\n<td></td>\n<td>journalnode</td>\n<td>8485</td>\n<td>dfs.journalnode.rpc-address</td>\n<td>RPC服务</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8480</td>\n<td>dfs.journalnode.http-address</td>\n<td>HTTP服务</td>\n</tr>\n<tr>\n<td></td>\n<td>ZKFC</td>\n<td>8019</td>\n<td>dfs.ha.zkfc.port</td>\n<td>ZooKeeper FailoverController，用于NN HA</td>\n</tr>\n<tr>\n<td>YARN</td>\n<td>ResourceManager</td>\n<td>8032</td>\n<td>yarn.resourcemanager.address</td>\n<td>RM的applications manager(ASM)端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8030</td>\n<td>yarn.resourcemanager.scheduler.address</td>\n<td>scheduler组件的IPC端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8031</td>\n<td>yarn.resourcemanager.resource-tracker.address</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8033</td>\n<td>yarn.resourcemanager.admin.address</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8088</td>\n<td>yarn.resourcemanager.webapp.address</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td>NodeManager</td>\n<td>8040</td>\n<td>yarn.nodemanager.localizer.address</td>\n<td>localizer IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8042</td>\n<td>yarn.nodemanager.webapp.address</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8041</td>\n<td>yarn.nodemanager.address</td>\n<td>NM中container manager的端口</td>\n</tr>\n<tr>\n<td></td>\n<td>JobHistory Server</td>\n<td>10020</td>\n<td>mapreduce.jobhistory.address</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>19888</td>\n<td>mapreduce.jobhistory.webapp.address</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td>HBase</td>\n<td>Master</td>\n<td>60000</td>\n<td>hbase.master.port</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>60010</td>\n<td>hbase.master.info.port</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td>RegionServer</td>\n<td>60020</td>\n<td>hbase.regionserver.port</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>60030</td>\n<td>hbase.regionserver.info.port</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td>HQuorumPeer</td>\n<td>2181</td>\n<td>hbase.zookeeper.property.clientPort</td>\n<td>HBase-managed ZK mode，使用独立的ZooKeeper集群则不会启用该端口。</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>2888</td>\n<td>hbase.zookeeper.peerport</td>\n<td>HBase-managed ZK mode，使用独立的ZooKeeper集群则不会启用该端口。</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>3888</td>\n<td>hbase.zookeeper.leaderport</td>\n<td>HBase-managed ZK mode，使用独立的ZooKeeper集群则不会启用该端口。</td>\n</tr>\n<tr>\n<td>Hive</td>\n<td>Metastore</td>\n<td>9083</td>\n<td>/etc/default/hive-metastore中export PORT=<port>来更新默认端口</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>HiveServer</td>\n<td>10000</td>\n<td>/etc/hive/conf/hive-env.sh中export HIVE_SERVER2_THRIFT_PORT=<port>来更新默认端口</td>\n<td></td>\n</tr>\n<tr>\n<td>ZooKeeper</td>\n<td>Server</td>\n<td>2181</td>\n<td>/etc/zookeeper/conf/zoo.cfg中clientPort=<port></td>\n<td>对客户端提供服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>2888</td>\n<td>/etc/zookeeper/conf/zoo.cfg中server.x=[hostname]:nnnnn[:nnnnn]，标蓝部分</td>\n<td>follower用来连接到leader，只在leader上监听该端口。</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>3888</td>\n<td>/etc/zookeeper/conf/zoo.cfg中server.x=[hostname]:nnnnn[:nnnnn]，标蓝部分</td>\n<td>用于leader选举的。只在electionAlg是1,2或3(默认)时需要。</td>\n</tr>\n</tbody></table>\n","more":"<p>[toc]</p>\n<h4 id=\"centos下-Hive搭建（mysql、hadoop-、jdk）\"><a href=\"#centos下-Hive搭建（mysql、hadoop-、jdk）\" class=\"headerlink\" title=\"centos下 Hive搭建（mysql、hadoop 、jdk）\"></a>centos下 Hive搭建（mysql、hadoop 、jdk）</h4><h4 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h4><ol>\n<li><p> wget <a href=\"https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\">https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm</a></p>\n</li>\n<li><p>```<br> rpm -ivh mysql80-community-release-el7-3.noarch.rpm</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">3.  &#96;&#96;&#96;</span><br><span class=\"line\">    yum install mysql-community-server -y</span><br><span class=\"line\">    systemctl enable mysqld</span><br><span class=\"line\">    systemctl start mysqld</span><br><span class=\"line\">    grep &#39;temporary password&#39; &#x2F;var&#x2F;log&#x2F;mysqld.log #获得密码</span><br><span class=\"line\">    mysql -u root -p</span><br><span class=\"line\">    mysql&gt; set global validate_password.policy&#x3D;0;</span><br><span class=\"line\">    mysql&gt; set global validate_password.length&#x3D;1;</span><br><span class=\"line\">    mysql&gt; alter user &#39;root&#39;@&#39;localhost&#39; identified by &#39;password&#39;;</span><br><span class=\"line\">    firewall-cmd --zone&#x3D;public --add-port&#x3D;3306&#x2F;tcp --permanent</span><br><span class=\"line\">    firewall-cmd --reload</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>完整脚本</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm</span><br><span class=\"line\">rpm -ivh mysql80-community-release-el7-3.noarch.rpm</span><br><span class=\"line\">yum install mysql-community-server -y</span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> mysqld</span><br><span class=\"line\">systemctl start mysqld</span><br><span class=\"line\">grep <span class=\"string\">&#x27;temporary password&#x27;</span> /var/<span class=\"built_in\">log</span>/mysqld.log <span class=\"comment\">#获得密码</span></span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">mysql&gt; <span class=\"built_in\">set</span> global validate_password.policy=0;</span><br><span class=\"line\">mysql&gt; <span class=\"built_in\">set</span> global validate_password.length=1;</span><br><span class=\"line\">mysql&gt; alter user <span class=\"string\">&#x27;root&#x27;</span>@<span class=\"string\">&#x27;localhost&#x27;</span> identified by <span class=\"string\">&#x27;password&#x27;</span>;</span><br><span class=\"line\">firewall-cmd --zone=public --add-port=3306/tcp --permanent</span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"hadoop安装\"><a href=\"#hadoop安装\" class=\"headerlink\" title=\"hadoop安装\"></a>hadoop安装</h4><p>Hadoop的核心由3个部分组成：</p>\n<p>  HDFS: Hadoop Distributed File System，分布式文件系统，hdfs还可以再细分为NameNode、SecondaryNameNode、DataNode。</p>\n<p>  YARN: Yet Another Resource Negotiator，资源管理调度系统</p>\n<p>  Mapreduce：分布式运算框架</p>\n<p>1.安装jdk7或8（不支持11）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载</span></span><br><span class=\"line\">wget -O jdk-8u131-linux-x64.tar.gz --no-check-certificate --no-cookies --header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\">tar zxvf ~/jdk-8u131-linux-x64.tar.gz -C /usr/local/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置环境</span></span><br><span class=\"line\">vi /etc/profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">  后面添加</span></span><br><span class=\"line\">export JAVA_HOME=/usr/local/jdk1.8.0_131</span><br><span class=\"line\">export CLASSPATH=$CLASSPATH:$JAVA_HOME/lib/</span><br><span class=\"line\">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">重新加载配置</span></span><br><span class=\"line\">source /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">验证</span></span><br><span class=\"line\">java -version</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载hadoop</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> wget https://downloads.apache.org/hadoop/common/hadoop-3.2.2/hadoop-3.2.2.tar.gz</span></span><br><span class=\"line\">wget http://mirror.bit.edu.cn/apache/hadoop/common/hadoop-2.10.1/hadoop-2.10.1.tar.gz</span><br><span class=\"line\">tar zxvf hadoop-2.10.1.tar.gz -C /usr/local/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">配置jdk</span></span><br><span class=\"line\">vi $&#123;HADOOP_HMOE&#125;/etc/hadoop/hadoop-003env.sh</span><br><span class=\"line\">export JAVA_HOME=/usr/local/jdk1.8.0_131/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">设置伪分布模式（Pseudo-Distributed Operation）修改etc/hadoop/core-site.xml文件，增加配置（fs.defaultFS：默认文件系统名称）：</span></span><br><span class=\"line\">vi $&#123;HADOOP_HMOE&#125;/etc/hadoop/core-site.xml</span><br><span class=\"line\">&lt;configuration&gt;</span><br><span class=\"line\">    &lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;</span><br><span class=\"line\">    &lt;/property&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"> #</span><span class=\"bash\"> 修改etc/hadoop/hdfs-site.xml文件，增加配置（dfs.replication：文件副本数）：</span></span><br><span class=\"line\"> &lt;configuration&gt;</span><br><span class=\"line\">    &lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;1&lt;/value&gt;</span><br><span class=\"line\">    &lt;/property&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">格式化文件系统</span></span><br><span class=\"line\">/usr/local/hadoop-2.10.1/bin/hdfs namenode -format</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动NameNode和DataNode进程（启动hdfs）</span></span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/start-dfs.sh // 启动NameNode和DataNode进程</span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/stop-dfs.sh  // 关闭NameNode和DataNode进程</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">查看HDFS验证成功</span></span><br><span class=\"line\">http://172.20.19.33:50070</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动yarn</span></span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/start-yarn.sh</span><br><span class=\"line\">/usr/local/hadoop-2.10.1/sbin/stop-yarn.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">查看YARN</span></span><br><span class=\"line\">http://172.20.19.33:8088/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置环境</span></span><br><span class=\"line\">vi /etc/profile</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">  后面添加</span></span><br><span class=\"line\">export HADOOP_HOME=/usr/local/hadoop-2.10.1</span><br><span class=\"line\">export PATH=$PATH:$HADOOP_HOME/bin</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">重新加载配置</span></span><br><span class=\"line\">source /etc/profile</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Hive安装\"><a href=\"#Hive安装\" class=\"headerlink\" title=\"Hive安装\"></a>Hive安装</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 下载</span></span><br><span class=\"line\">wget https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz -c #比较慢，断点下载</span><br><span class=\"line\">tar zxvf apache-hive-3.1.2-bin.tar.gz -C /usr/local/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">改名去bin</span></span><br><span class=\"line\">mv apache-hive-3.1.2-bin/ apache-hive-3.1.2/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">配置</span></span><br><span class=\"line\">cd /usr/local/apache-hive-3.1.2/conf/</span><br><span class=\"line\">cp hive-log4j2.properties.template hive-log4j2.properties</span><br><span class=\"line\">vi /usr/local/apache-hive-3.1.2/conf/hive-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span><br><span class=\"line\">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class=\"line\">&lt;configuration&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class=\"line\">    &lt;value&gt;jdbc:mysql://172.20.19.33:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt;</span><br><span class=\"line\">　&lt;/property&gt;</span><br><span class=\"line\">　&lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class=\"line\">　　&lt;value&gt;com.mysql.cj.jdbc.Driver&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class=\"line\">    &lt;value&gt;root&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class=\"line\">    &lt;value&gt;password&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">&lt;/configuration&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">初始化数据库</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">下载并拷贝protobuf-java-3.6.1.jar和mysql-connector-java-8.0.17.jar到<span class=\"variable\">$HIVE_HOME</span>/lib目录下，删除已有的protobuf-java-2.5.0.jar文件。统一hive和mysql服务的时区。</span></span><br><span class=\"line\">wget -c https://repo1.maven.org/maven2/com/google/protobuf/protobuf-java/3.6.1/protobuf-java-3.6.1.jar</span><br><span class=\"line\">wget -c https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.17/mysql-connector-java-8.0.17.jar</span><br><span class=\"line\">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # hive和mysql服务器都要执行，mysql要重启服务</span><br><span class=\"line\">cd /usr/local/apache-hive-3.1.2/bin/</span><br><span class=\"line\">/usr/local/apache-hive-3.1.2/bin/schematool -dbType mysql -initSchema # 报错需要修改mysql访问权限</span><br><span class=\"line\">/usr/local/apache-hive-3.1.2/bin/hive</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">  启动hiveserver2：</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 修改<span class=\"variable\">$HADOOP_HOME</span>/etc/hadoop/core-site.xml文件，增加如下配置：</span></span><br><span class=\"line\">vi /usr/local/hadoop-2.10.1/etc/hadoop/core-site.xml</span><br><span class=\"line\">&lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\">&lt;property&gt;</span><br><span class=\"line\">        &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\">&lt;property&gt;</span><br><span class=\"line\">         &lt;name&gt;hadoop.proxyuser.hadoop.hosts&lt;/name&gt;</span><br><span class=\"line\">        &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\"> &lt;property&gt;</span><br><span class=\"line\">         &lt;name&gt;hadoop.proxyuser.hadoop.groups&lt;/name&gt;</span><br><span class=\"line\">         &lt;value&gt;*&lt;/value&gt;</span><br><span class=\"line\">&lt;/property&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">vi /usr/local/apache-hive-3.1.2/conf/hive-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">     &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;</span><br><span class=\"line\">     &lt;value&gt;10000&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\">  &lt;property&gt;</span><br><span class=\"line\">     &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;</span><br><span class=\"line\">     &lt;value&gt;172.20.19.33&lt;/value&gt;</span><br><span class=\"line\">  &lt;/property&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">/usr/local/apache-hive-3.1.2/bin/hiveserver2 &amp;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>mysql权限修改</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 改表法</span></span><br><span class=\"line\">mysql -u root -pvmware</span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span><span class=\"bash\">use mysql;</span></span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span><span class=\"bash\">update user <span class=\"built_in\">set</span> host = <span class=\"string\">&#x27;%&#x27;</span> <span class=\"built_in\">where</span> user = <span class=\"string\">&#x27;root&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span><span class=\"bash\">flush privileges;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h5 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h5><p><strong>Hive Shell 、Hive Web UI及JDBC 三种连接Hive Server的方式是互斥的，同一时刻只能用一种方式连接</strong></p>\n<h3 id=\"端口说明\"><a href=\"#端口说明\" class=\"headerlink\" title=\"端口说明\"></a>端口说明</h3><table>\n<thead>\n<tr>\n<th>组件</th>\n<th>Daemon</th>\n<th>端口</th>\n<th>配置</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>HDFS</td>\n<td>DataNode</td>\n<td>50010</td>\n<td>dfs.datanode.address</td>\n<td>datanode服务端口，用于数据传输</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50075</td>\n<td>dfs.datanode.http.address</td>\n<td>http服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50475</td>\n<td>dfs.datanode.https.address</td>\n<td>https服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50020</td>\n<td>dfs.datanode.ipc.address</td>\n<td>ipc服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td>NameNode</td>\n<td>50070</td>\n<td>dfs.namenode.http-address</td>\n<td>http服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>50470</td>\n<td>dfs.namenode.https-address</td>\n<td>https服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8020</td>\n<td>fs.defaultFS</td>\n<td>接收Client连接的RPC端口，用于获取文件系统metadata信息。</td>\n</tr>\n<tr>\n<td></td>\n<td>journalnode</td>\n<td>8485</td>\n<td>dfs.journalnode.rpc-address</td>\n<td>RPC服务</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8480</td>\n<td>dfs.journalnode.http-address</td>\n<td>HTTP服务</td>\n</tr>\n<tr>\n<td></td>\n<td>ZKFC</td>\n<td>8019</td>\n<td>dfs.ha.zkfc.port</td>\n<td>ZooKeeper FailoverController，用于NN HA</td>\n</tr>\n<tr>\n<td>YARN</td>\n<td>ResourceManager</td>\n<td>8032</td>\n<td>yarn.resourcemanager.address</td>\n<td>RM的applications manager(ASM)端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8030</td>\n<td>yarn.resourcemanager.scheduler.address</td>\n<td>scheduler组件的IPC端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8031</td>\n<td>yarn.resourcemanager.resource-tracker.address</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8033</td>\n<td>yarn.resourcemanager.admin.address</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8088</td>\n<td>yarn.resourcemanager.webapp.address</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td>NodeManager</td>\n<td>8040</td>\n<td>yarn.nodemanager.localizer.address</td>\n<td>localizer IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8042</td>\n<td>yarn.nodemanager.webapp.address</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>8041</td>\n<td>yarn.nodemanager.address</td>\n<td>NM中container manager的端口</td>\n</tr>\n<tr>\n<td></td>\n<td>JobHistory Server</td>\n<td>10020</td>\n<td>mapreduce.jobhistory.address</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>19888</td>\n<td>mapreduce.jobhistory.webapp.address</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td>HBase</td>\n<td>Master</td>\n<td>60000</td>\n<td>hbase.master.port</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>60010</td>\n<td>hbase.master.info.port</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td>RegionServer</td>\n<td>60020</td>\n<td>hbase.regionserver.port</td>\n<td>IPC</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>60030</td>\n<td>hbase.regionserver.info.port</td>\n<td>http服务端口</td>\n</tr>\n<tr>\n<td></td>\n<td>HQuorumPeer</td>\n<td>2181</td>\n<td>hbase.zookeeper.property.clientPort</td>\n<td>HBase-managed ZK mode，使用独立的ZooKeeper集群则不会启用该端口。</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>2888</td>\n<td>hbase.zookeeper.peerport</td>\n<td>HBase-managed ZK mode，使用独立的ZooKeeper集群则不会启用该端口。</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>3888</td>\n<td>hbase.zookeeper.leaderport</td>\n<td>HBase-managed ZK mode，使用独立的ZooKeeper集群则不会启用该端口。</td>\n</tr>\n<tr>\n<td>Hive</td>\n<td>Metastore</td>\n<td>9083</td>\n<td>/etc/default/hive-metastore中export PORT=<port>来更新默认端口</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>HiveServer</td>\n<td>10000</td>\n<td>/etc/hive/conf/hive-env.sh中export HIVE_SERVER2_THRIFT_PORT=<port>来更新默认端口</td>\n<td></td>\n</tr>\n<tr>\n<td>ZooKeeper</td>\n<td>Server</td>\n<td>2181</td>\n<td>/etc/zookeeper/conf/zoo.cfg中clientPort=<port></td>\n<td>对客户端提供服务的端口</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>2888</td>\n<td>/etc/zookeeper/conf/zoo.cfg中server.x=[hostname]:nnnnn[:nnnnn]，标蓝部分</td>\n<td>follower用来连接到leader，只在leader上监听该端口。</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>3888</td>\n<td>/etc/zookeeper/conf/zoo.cfg中server.x=[hostname]:nnnnn[:nnnnn]，标蓝部分</td>\n<td>用于leader选举的。只在electionAlg是1,2或3(默认)时需要。</td>\n</tr>\n</tbody></table>\n","categories":[{"name":"编程技术","path":"api/categories/编程技术.json"}],"tags":[{"name":"应用","path":"api/tags/应用.json"}]}