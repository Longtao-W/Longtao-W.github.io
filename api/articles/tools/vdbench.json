{"title":"vdbench的使用","slug":"tools/vdbench","date":"2021-03-16T15:21:21.000Z","updated":"2024-06-30T10:35:56.312Z","comments":true,"path":"api/articles/tools/vdbench.json","excerpt":null,"covers":null,"content":"<p>ssh免密配置</p>\n<p>参考：<a href=\"https://blog.csdn.net/SweeNeil/article/details/95338293\">https://blog.csdn.net/SweeNeil/article/details/95338293</a></p>\n<ol>\n<li> 使用Vdbench测试工具对所有虚拟机磁盘进行压力测试，vdbench测试工具脚本主机定义设置如下：</li>\n</ol>\n<p>hd=default,vdbench=/home/vdbench,user=root,shell=ssh</p>\n<p>hd=hd1,system=node1</p>\n<p>hd=hd2,system=node2</p>\n<p>hd=hd3,system=node3</p>\n<p>……</p>\n<ol>\n<li> 设置测试工具模型为8k块大小随机读，测试数据量为块存储总SSD缓存大小的1倍。在压力虚拟机上运行Vdbench测试工具。存储定义、工作负载定义、运行定义设置如下：</li>\n</ol>\n<p>sd=sd1,hd=hd1,lun=/dev/sdb,openflags=o_direct,hitarea=1G,threads=1（厂家自行调整）</p>\n<p>……</p>\n<p>wd=wd1,sd=sd*,seekpct=100,rdpct=100,rhpct=60,xfersize=8k </p>\n<p>rd=rd1,wd=wd1,iorate=max,elapsed=604800,maxdata=数据量,interval=5,warmup=30</p>\n<ol>\n<li> 记录平均读写IOPS</li>\n</ol>\n<p>master</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.197</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.196</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.185</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.173</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.171</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.165</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hd&#x3D;default,vdbench&#x3D;&#x2F;home&#x2F;vdbench,user&#x3D;root,shell&#x3D;ssh</span><br><span class=\"line\">hd&#x3D;hd1,system&#x3D;172.18.2.197</span><br><span class=\"line\">hd&#x3D;hd2,system&#x3D;172.18.2.196</span><br><span class=\"line\">hd&#x3D;hd3,system&#x3D;172.18.2.185</span><br><span class=\"line\">hd&#x3D;hd4,system&#x3D;172.18.2.173</span><br><span class=\"line\">hd&#x3D;hd5,system&#x3D;172.18.2.171</span><br><span class=\"line\">hd&#x3D;hd6,system&#x3D;172.18.2.165</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">sd&#x3D;sd1,hd&#x3D;hd1,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd2,hd&#x3D;hd1,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd3,hd&#x3D;hd2,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd4,hd&#x3D;hd2,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd5,hd&#x3D;hd3,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd6,hd&#x3D;hd3,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd7,hd&#x3D;hd4,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd8,hd&#x3D;hd4,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd9,hd&#x3D;hd5,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd10,hd&#x3D;h5,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd11,hd&#x3D;hd6,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd12,hd&#x3D;hd6,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\"></span><br><span class=\"line\">wd&#x3D;wd1,sd&#x3D;sd*,seekpct&#x3D;100,rdpct&#x3D;0,rhpct&#x3D;60,xfersize&#x3D;8k</span><br><span class=\"line\"></span><br><span class=\"line\">rd&#x3D;rd1,wd&#x3D;wd1,iorate&#x3D;max,elapsed&#x3D;604800,maxdata&#x3D;150G,interval&#x3D;5,warmup&#x3D;30</span><br></pre></td></tr></table></figure>\n\n","more":"<p>ssh免密配置</p>\n<p>参考：<a href=\"https://blog.csdn.net/SweeNeil/article/details/95338293\">https://blog.csdn.net/SweeNeil/article/details/95338293</a></p>\n<ol>\n<li> 使用Vdbench测试工具对所有虚拟机磁盘进行压力测试，vdbench测试工具脚本主机定义设置如下：</li>\n</ol>\n<p>hd=default,vdbench=/home/vdbench,user=root,shell=ssh</p>\n<p>hd=hd1,system=node1</p>\n<p>hd=hd2,system=node2</p>\n<p>hd=hd3,system=node3</p>\n<p>……</p>\n<ol>\n<li> 设置测试工具模型为8k块大小随机读，测试数据量为块存储总SSD缓存大小的1倍。在压力虚拟机上运行Vdbench测试工具。存储定义、工作负载定义、运行定义设置如下：</li>\n</ol>\n<p>sd=sd1,hd=hd1,lun=/dev/sdb,openflags=o_direct,hitarea=1G,threads=1（厂家自行调整）</p>\n<p>……</p>\n<p>wd=wd1,sd=sd*,seekpct=100,rdpct=100,rhpct=60,xfersize=8k </p>\n<p>rd=rd1,wd=wd1,iorate=max,elapsed=604800,maxdata=数据量,interval=5,warmup=30</p>\n<ol>\n<li> 记录平均读写IOPS</li>\n</ol>\n<p>master</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.197</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.196</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.185</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.173</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.171</span><br><span class=\"line\">ssh-copy-id -i &#x2F;root&#x2F;.ssh&#x2F;id_rsa.pub root@172.18.2.165</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hd&#x3D;default,vdbench&#x3D;&#x2F;home&#x2F;vdbench,user&#x3D;root,shell&#x3D;ssh</span><br><span class=\"line\">hd&#x3D;hd1,system&#x3D;172.18.2.197</span><br><span class=\"line\">hd&#x3D;hd2,system&#x3D;172.18.2.196</span><br><span class=\"line\">hd&#x3D;hd3,system&#x3D;172.18.2.185</span><br><span class=\"line\">hd&#x3D;hd4,system&#x3D;172.18.2.173</span><br><span class=\"line\">hd&#x3D;hd5,system&#x3D;172.18.2.171</span><br><span class=\"line\">hd&#x3D;hd6,system&#x3D;172.18.2.165</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">sd&#x3D;sd1,hd&#x3D;hd1,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd2,hd&#x3D;hd1,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd3,hd&#x3D;hd2,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd4,hd&#x3D;hd2,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd5,hd&#x3D;hd3,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd6,hd&#x3D;hd3,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd7,hd&#x3D;hd4,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd8,hd&#x3D;hd4,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd9,hd&#x3D;hd5,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd10,hd&#x3D;h5,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd11,hd&#x3D;hd6,lun&#x3D;&#x2F;dev&#x2F;sdb,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\">sd&#x3D;sd12,hd&#x3D;hd6,lun&#x3D;&#x2F;dev&#x2F;sda,openflags&#x3D;o_direct,hitarea&#x3D;1G,threads&#x3D;1</span><br><span class=\"line\"></span><br><span class=\"line\">wd&#x3D;wd1,sd&#x3D;sd*,seekpct&#x3D;100,rdpct&#x3D;0,rhpct&#x3D;60,xfersize&#x3D;8k</span><br><span class=\"line\"></span><br><span class=\"line\">rd&#x3D;rd1,wd&#x3D;wd1,iorate&#x3D;max,elapsed&#x3D;604800,maxdata&#x3D;150G,interval&#x3D;5,warmup&#x3D;30</span><br></pre></td></tr></table></figure>\n\n","categories":[{"name":"编程技术","path":"api/categories/编程技术.json"}],"tags":[{"name":"工具","path":"api/tags/工具.json"}]}