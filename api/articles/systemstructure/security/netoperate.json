{"title":"网络查询、嗅探","slug":"systemstructure/security/netoperate","date":"2020-09-26T15:00:21.000Z","updated":"2024-06-30T10:35:56.308Z","comments":true,"path":"api/articles/systemstructure/security/netoperate.json","excerpt":null,"covers":null,"content":"<p>[toc]</p>\n<h4 id=\"查自己的公网ip\"><a href=\"#查自己的公网ip\" class=\"headerlink\" title=\"查自己的公网ip\"></a>查自己的公网ip</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ curl http://members.3322.org/dyndns/getip</span><br><span class=\"line\">150.118.52.133</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 或者</span></span><br><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ curl ip.</span><br><span class=\"line\">150.118.52.133</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查询域名的ip地址\"><a href=\"#查询域名的ip地址\" class=\"headerlink\" title=\"查询域名的ip地址\"></a>查询域名的ip地址</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ nslookup www.baidu.com</span><br><span class=\"line\">Server:\t\t127.0.0.53 #dns服务器</span><br><span class=\"line\">Address:\t127.0.0.53#53</span><br><span class=\"line\"></span><br><span class=\"line\">Non-authoritative answer:</span><br><span class=\"line\">www.baidu.com\tcanonical name = www.a.shifen.com.# 域名实际对应的主机名记录</span><br><span class=\"line\">Name:\twww.a.shifen.com </span><br><span class=\"line\">Address: 150.101.49.12 #域名负载均衡</span><br><span class=\"line\">Name:\twww.a.shifen.com</span><br><span class=\"line\">Address: 150.101.49.11</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查询目标ip对应的mac地址\"><a href=\"#查询目标ip对应的mac地址\" class=\"headerlink\" title=\"查询目标ip对应的mac地址\"></a>查询目标ip对应的mac地址</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 用ping获取arp缓存再查找</span></span><br><span class=\"line\">[root@localhost ~]# ping 127.0.1.21 -c 1 &gt;&gt; /dev/null;arp -a 127.0.1.21|awk -F &quot; &quot; &#x27;&#123;print $4&#125;&#x27;</span><br><span class=\"line\">14:02:ec:32:cc:24</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"修改网卡mac地址\"><a href=\"#修改网卡mac地址\" class=\"headerlink\" title=\"修改网卡mac地址\"></a>修改网卡mac地址</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ifconfig eth0 hw ether B3:00:00:00:00:A2#临时修改</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"嗅探目标ip的信息\"><a href=\"#嗅探目标ip的信息\" class=\"headerlink\" title=\"嗅探目标ip的信息\"></a>嗅探目标ip的信息</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 嗅探目标ip端口开发情况</span></span><br><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ sudo nmap -PS 180.101.49.12</span><br><span class=\"line\">Starting Nmap 7.80 ( https://nmap.org ) at 2021-08-20 15:08 CST</span><br><span class=\"line\">Nmap scan report for 180.101.49.12</span><br><span class=\"line\">Host is up (0.0079s latency).</span><br><span class=\"line\">Not shown: 998 filtered ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">443/tcp open  https</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 嗅探目标ip系统信息</span></span><br><span class=\"line\">sudo nmap -O 180.101.49.12</span><br><span class=\"line\">tarting Nmap 7.80 ( https://nmap.org ) at 2021-08-20 14:59 CST</span><br><span class=\"line\">Nmap scan report for 180.101.49.12</span><br><span class=\"line\">Host is up (0.0084s latency).</span><br><span class=\"line\">Not shown: 998 filtered ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">443/tcp open  https</span><br><span class=\"line\">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class=\"line\">Aggressive OS guesses: Linux 2.6.18 - 2.6.22 (92%), D-Link DWL-624+ or DWL-2000AP, or TRENDnet TEW-432BRP WAP (90%), OneAccess 1641 router (90%), 3Com SuperStack 3 Switch 3870 (88%), HP ProCurve 2524 switch or 9100c Digital Sender printer (86%), Blue Coat PacketShaper appliance (86%), Satel ETHM-2 intruder alarm (86%), Apple TV 5.2.1 or 5.3 (86%), AVtech Room Alert 26W environmental monitor (85%)</span><br><span class=\"line\">No exact OS matches for host (test conditions non-ideal).</span><br><span class=\"line\"></span><br><span class=\"line\">OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class=\"line\">Nmap done: 1 IP address (1 host up) scanned in 9.61 seconds</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 扫描整个网段所有ip</span></span><br><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ nmap  172.20.65.0/24</span><br><span class=\"line\">Starting Nmap 7.80 ( https://nmap.org ) at 2021-08-20 15:12 CST</span><br><span class=\"line\">Nmap scan report for 172.20.65.50</span><br><span class=\"line\">Host is up (0.00048s latency).</span><br><span class=\"line\">Not shown: 998 closed ports</span><br><span class=\"line\">PORT   STATE SERVICE</span><br><span class=\"line\">22/tcp open  ssh</span><br><span class=\"line\">80/tcp open  http</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap scan report for 172.20.65.62</span><br><span class=\"line\">Host is up (0.00022s latency).</span><br><span class=\"line\">Not shown: 996 closed ports</span><br><span class=\"line\">PORT     STATE SERVICE</span><br><span class=\"line\">22/tcp   open  ssh</span><br><span class=\"line\">80/tcp   open  http</span><br><span class=\"line\">8080/tcp open  http-proxy</span><br><span class=\"line\">8888/tcp open  sun-answerbook</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap scan report for 172.20.65.77</span><br><span class=\"line\">Host is up (0.00023s latency).</span><br><span class=\"line\">Not shown: 998 closed ports</span><br><span class=\"line\">PORT   STATE SERVICE</span><br><span class=\"line\">22/tcp open  ssh</span><br><span class=\"line\">80/tcp open  http</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap scan report for 172.20.65.84</span><br><span class=\"line\">Host is up (0.00046s latency).</span><br><span class=\"line\">Not shown: 997 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">22/tcp  open  ssh</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">999/tcp open  garcon</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"模拟发包\"><a href=\"#模拟发包\" class=\"headerlink\" title=\"模拟发包\"></a>模拟发包</h4><p>使用hping3模拟发包</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c --count count 发送数据包的次数</span><br><span class=\"line\">-i --interval 包发送间隔时间（单位是毫秒）缺省时间是1秒</span><br><span class=\"line\">-n -nmeric 数字输出，象征性输出主机地址。</span><br><span class=\"line\">-I --interface 网络接口名如eth0。</span><br><span class=\"line\">-v --verbose 显示很多信息，</span><br><span class=\"line\">-D --debug 进入debug模式</span><br><span class=\"line\">-z --bind 快捷键的使用。</span><br><span class=\"line\">-Z --unbind 消除快捷键。</span><br><span class=\"line\">-O --rawip RAWIP模式，在此模式下HPING会发送带数据的IP头。</span><br><span class=\"line\">-1 --icmp ICMP模式，此模式下HPING会发送IGMP应答报，你可以用--ICMPTYPE --ICMPCODE选项发送其他类型/模式的ICMP报文。</span><br><span class=\"line\">-2 --udp UDP 模式，缺省下，HPING会发送UDP报文到主机的0端口，你可以用--baseport --destport --keep选项指定其模式。</span><br><span class=\"line\">-9 --listen signatuer hping的listen模式，用此模式，HPING会接收指定的数据。</span><br><span class=\"line\">-a --spoof hostname 伪造IP攻击，防火墙就不会记录你的真实IP了，当然回应的包你也接收不到了。</span><br><span class=\"line\">-t --ttl time to live 可以指定发出包的TTL值。</span><br><span class=\"line\">-H --ipproto 在RAW IP模式里选择IP协议。</span><br><span class=\"line\">-w --WINID UNIX ,WINDIWS的id回应不同的，这选项可以让你的ID回应和WINDOWS一样。</span><br><span class=\"line\">-r --rel 更改ID的，可以让ID曾递减输出，详见HPING-HOWTO。</span><br><span class=\"line\">-F --FRAG 更改包的FRAG，这可以测试对方对于包碎片的处理能力，缺省的“virtual mtu”是16字节。</span><br><span class=\"line\">-x --morefrag 此功能可以发送碎片使主机忙于恢复碎片而造成主机的拒绝服务。</span><br><span class=\"line\">-y -dontfrag 发送不可恢复的IP碎片，这可以让你了解更多的MTU PATH DISCOVERY。</span><br><span class=\"line\">-G --fragoff fragment offset value set the fragment offset</span><br><span class=\"line\">-m --mtu mtu value 用此项后ID数值变得很大，50000没指定此项时3000-20000左右。</span><br><span class=\"line\">-G --rroute 记录路由，可以看到详悉的数据等等，最多可以经过9个路由，即使主机屏蔽了ICMP报文</span><br><span class=\"line\">-C --ICMPTYPE type 指定ICMP类型，缺省是ICMP echo REQUEST</span><br><span class=\"line\">-K --ICMPCODE CODE 指定ICMP代号，缺省0</span><br><span class=\"line\">--icmp-ipver 把IP版本也插入IP头</span><br><span class=\"line\">--icmp-iphlen 设置IP头的长度，缺省为5（32字节）</span><br><span class=\"line\">--icmp-iplen 设置IP包长度</span><br><span class=\"line\">-s --baseport source port hping 用源端口猜测回应的包</span><br><span class=\"line\">-p --deskport [+][+]desk port 设置目标端口，缺省为0，一个加号设置为:每发送一个请求包到达后，端口加1，两个加号为：每发一个包，端口数加1</span><br><span class=\"line\">-w --win 发windows包，64BYTE</span><br><span class=\"line\">-O --tcpoff 设置tcp偏移</span><br><span class=\"line\">-m --tcpseq 设置TCP序列数</span><br><span class=\"line\">-l --tcpck 设置TCP ack</span><br><span class=\"line\">-Q --seqnum 搜集序列号</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n","more":"<p>[toc]</p>\n<h4 id=\"查自己的公网ip\"><a href=\"#查自己的公网ip\" class=\"headerlink\" title=\"查自己的公网ip\"></a>查自己的公网ip</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ curl http://members.3322.org/dyndns/getip</span><br><span class=\"line\">150.118.52.133</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 或者</span></span><br><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ curl ip.</span><br><span class=\"line\">150.118.52.133</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查询域名的ip地址\"><a href=\"#查询域名的ip地址\" class=\"headerlink\" title=\"查询域名的ip地址\"></a>查询域名的ip地址</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ nslookup www.baidu.com</span><br><span class=\"line\">Server:\t\t127.0.0.53 #dns服务器</span><br><span class=\"line\">Address:\t127.0.0.53#53</span><br><span class=\"line\"></span><br><span class=\"line\">Non-authoritative answer:</span><br><span class=\"line\">www.baidu.com\tcanonical name = www.a.shifen.com.# 域名实际对应的主机名记录</span><br><span class=\"line\">Name:\twww.a.shifen.com </span><br><span class=\"line\">Address: 150.101.49.12 #域名负载均衡</span><br><span class=\"line\">Name:\twww.a.shifen.com</span><br><span class=\"line\">Address: 150.101.49.11</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"查询目标ip对应的mac地址\"><a href=\"#查询目标ip对应的mac地址\" class=\"headerlink\" title=\"查询目标ip对应的mac地址\"></a>查询目标ip对应的mac地址</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 用ping获取arp缓存再查找</span></span><br><span class=\"line\">[root@localhost ~]# ping 127.0.1.21 -c 1 &gt;&gt; /dev/null;arp -a 127.0.1.21|awk -F &quot; &quot; &#x27;&#123;print $4&#125;&#x27;</span><br><span class=\"line\">14:02:ec:32:cc:24</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"修改网卡mac地址\"><a href=\"#修改网卡mac地址\" class=\"headerlink\" title=\"修改网卡mac地址\"></a>修改网卡mac地址</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ifconfig eth0 hw ether B3:00:00:00:00:A2#临时修改</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"嗅探目标ip的信息\"><a href=\"#嗅探目标ip的信息\" class=\"headerlink\" title=\"嗅探目标ip的信息\"></a>嗅探目标ip的信息</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 嗅探目标ip端口开发情况</span></span><br><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ sudo nmap -PS 180.101.49.12</span><br><span class=\"line\">Starting Nmap 7.80 ( https://nmap.org ) at 2021-08-20 15:08 CST</span><br><span class=\"line\">Nmap scan report for 180.101.49.12</span><br><span class=\"line\">Host is up (0.0079s latency).</span><br><span class=\"line\">Not shown: 998 filtered ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">443/tcp open  https</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 嗅探目标ip系统信息</span></span><br><span class=\"line\">sudo nmap -O 180.101.49.12</span><br><span class=\"line\">tarting Nmap 7.80 ( https://nmap.org ) at 2021-08-20 14:59 CST</span><br><span class=\"line\">Nmap scan report for 180.101.49.12</span><br><span class=\"line\">Host is up (0.0084s latency).</span><br><span class=\"line\">Not shown: 998 filtered ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">443/tcp open  https</span><br><span class=\"line\">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class=\"line\">Aggressive OS guesses: Linux 2.6.18 - 2.6.22 (92%), D-Link DWL-624+ or DWL-2000AP, or TRENDnet TEW-432BRP WAP (90%), OneAccess 1641 router (90%), 3Com SuperStack 3 Switch 3870 (88%), HP ProCurve 2524 switch or 9100c Digital Sender printer (86%), Blue Coat PacketShaper appliance (86%), Satel ETHM-2 intruder alarm (86%), Apple TV 5.2.1 or 5.3 (86%), AVtech Room Alert 26W environmental monitor (85%)</span><br><span class=\"line\">No exact OS matches for host (test conditions non-ideal).</span><br><span class=\"line\"></span><br><span class=\"line\">OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class=\"line\">Nmap done: 1 IP address (1 host up) scanned in 9.61 seconds</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 扫描整个网段所有ip</span></span><br><span class=\"line\">longtao@longtaoXiaoXinPro13-2020:~$ nmap  172.20.65.0/24</span><br><span class=\"line\">Starting Nmap 7.80 ( https://nmap.org ) at 2021-08-20 15:12 CST</span><br><span class=\"line\">Nmap scan report for 172.20.65.50</span><br><span class=\"line\">Host is up (0.00048s latency).</span><br><span class=\"line\">Not shown: 998 closed ports</span><br><span class=\"line\">PORT   STATE SERVICE</span><br><span class=\"line\">22/tcp open  ssh</span><br><span class=\"line\">80/tcp open  http</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap scan report for 172.20.65.62</span><br><span class=\"line\">Host is up (0.00022s latency).</span><br><span class=\"line\">Not shown: 996 closed ports</span><br><span class=\"line\">PORT     STATE SERVICE</span><br><span class=\"line\">22/tcp   open  ssh</span><br><span class=\"line\">80/tcp   open  http</span><br><span class=\"line\">8080/tcp open  http-proxy</span><br><span class=\"line\">8888/tcp open  sun-answerbook</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap scan report for 172.20.65.77</span><br><span class=\"line\">Host is up (0.00023s latency).</span><br><span class=\"line\">Not shown: 998 closed ports</span><br><span class=\"line\">PORT   STATE SERVICE</span><br><span class=\"line\">22/tcp open  ssh</span><br><span class=\"line\">80/tcp open  http</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap scan report for 172.20.65.84</span><br><span class=\"line\">Host is up (0.00046s latency).</span><br><span class=\"line\">Not shown: 997 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">22/tcp  open  ssh</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">999/tcp open  garcon</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"模拟发包\"><a href=\"#模拟发包\" class=\"headerlink\" title=\"模拟发包\"></a>模拟发包</h4><p>使用hping3模拟发包</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-c --count count 发送数据包的次数</span><br><span class=\"line\">-i --interval 包发送间隔时间（单位是毫秒）缺省时间是1秒</span><br><span class=\"line\">-n -nmeric 数字输出，象征性输出主机地址。</span><br><span class=\"line\">-I --interface 网络接口名如eth0。</span><br><span class=\"line\">-v --verbose 显示很多信息，</span><br><span class=\"line\">-D --debug 进入debug模式</span><br><span class=\"line\">-z --bind 快捷键的使用。</span><br><span class=\"line\">-Z --unbind 消除快捷键。</span><br><span class=\"line\">-O --rawip RAWIP模式，在此模式下HPING会发送带数据的IP头。</span><br><span class=\"line\">-1 --icmp ICMP模式，此模式下HPING会发送IGMP应答报，你可以用--ICMPTYPE --ICMPCODE选项发送其他类型/模式的ICMP报文。</span><br><span class=\"line\">-2 --udp UDP 模式，缺省下，HPING会发送UDP报文到主机的0端口，你可以用--baseport --destport --keep选项指定其模式。</span><br><span class=\"line\">-9 --listen signatuer hping的listen模式，用此模式，HPING会接收指定的数据。</span><br><span class=\"line\">-a --spoof hostname 伪造IP攻击，防火墙就不会记录你的真实IP了，当然回应的包你也接收不到了。</span><br><span class=\"line\">-t --ttl time to live 可以指定发出包的TTL值。</span><br><span class=\"line\">-H --ipproto 在RAW IP模式里选择IP协议。</span><br><span class=\"line\">-w --WINID UNIX ,WINDIWS的id回应不同的，这选项可以让你的ID回应和WINDOWS一样。</span><br><span class=\"line\">-r --rel 更改ID的，可以让ID曾递减输出，详见HPING-HOWTO。</span><br><span class=\"line\">-F --FRAG 更改包的FRAG，这可以测试对方对于包碎片的处理能力，缺省的“virtual mtu”是16字节。</span><br><span class=\"line\">-x --morefrag 此功能可以发送碎片使主机忙于恢复碎片而造成主机的拒绝服务。</span><br><span class=\"line\">-y -dontfrag 发送不可恢复的IP碎片，这可以让你了解更多的MTU PATH DISCOVERY。</span><br><span class=\"line\">-G --fragoff fragment offset value set the fragment offset</span><br><span class=\"line\">-m --mtu mtu value 用此项后ID数值变得很大，50000没指定此项时3000-20000左右。</span><br><span class=\"line\">-G --rroute 记录路由，可以看到详悉的数据等等，最多可以经过9个路由，即使主机屏蔽了ICMP报文</span><br><span class=\"line\">-C --ICMPTYPE type 指定ICMP类型，缺省是ICMP echo REQUEST</span><br><span class=\"line\">-K --ICMPCODE CODE 指定ICMP代号，缺省0</span><br><span class=\"line\">--icmp-ipver 把IP版本也插入IP头</span><br><span class=\"line\">--icmp-iphlen 设置IP头的长度，缺省为5（32字节）</span><br><span class=\"line\">--icmp-iplen 设置IP包长度</span><br><span class=\"line\">-s --baseport source port hping 用源端口猜测回应的包</span><br><span class=\"line\">-p --deskport [+][+]desk port 设置目标端口，缺省为0，一个加号设置为:每发送一个请求包到达后，端口加1，两个加号为：每发一个包，端口数加1</span><br><span class=\"line\">-w --win 发windows包，64BYTE</span><br><span class=\"line\">-O --tcpoff 设置tcp偏移</span><br><span class=\"line\">-m --tcpseq 设置TCP序列数</span><br><span class=\"line\">-l --tcpck 设置TCP ack</span><br><span class=\"line\">-Q --seqnum 搜集序列号</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n","categories":[{"name":"编程技术","path":"api/categories/编程技术.json"}],"tags":[{"name":"编程原理","path":"api/tags/编程原理.json"},{"name":"网络","path":"api/tags/网络.json"}]}